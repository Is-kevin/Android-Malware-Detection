import numpy as np
from tranditionalway.MyReliefF import ReliefF   # 自己定义的类

# Relief method


class Relief:
    def __init__(self, X, y, topN):
        self.X = X
        self.y = y
        self.topN = topN

    # 返回特征的排序索引
    def rank(self):
        fs = ReliefF()
        fs.fit(self.X, self.y)
        scores = fs.feature_scores
        idx = sorted(enumerate(scores), key=lambda x: x[1], reverse=True)  # 每个元素为：编号，值
        top = np.array([idx[i][0] for i in range(self.topN)])
        return top